<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-You-Dont-Know-React/API/React Comp 19041">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="一句话解释一个知识点 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="一句话解释一个知识点 Atom Feed"><title data-rh="true">React.Component | 一句话解释一个知识点</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://neo-of-matrix.github.io/docs/You-Dont-Know-React/API/React Comp 19041/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="React.Component | 一句话解释一个知识点"><meta data-rh="true" name="description" content="概览"><meta data-rh="true" property="og:description" content="概览"><link data-rh="true" rel="icon" href="/img/favicon.jpg"><link data-rh="true" rel="canonical" href="https://neo-of-matrix.github.io/docs/You-Dont-Know-React/API/React Comp 19041/"><link data-rh="true" rel="alternate" href="https://neo-of-matrix.github.io/docs/You-Dont-Know-React/API/React Comp 19041/" hreflang="en"><link data-rh="true" rel="alternate" href="https://neo-of-matrix.github.io/docs/You-Dont-Know-React/API/React Comp 19041/" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.d25abd49.css">
<link rel="preload" href="/assets/js/runtime~main.674d6470.js" as="script">
<link rel="preload" href="/assets/js/main.68822ab4.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/favicon.jpg" alt="logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/favicon.jpg" alt="logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">首页</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/about/">笔记</a><a class="navbar__item navbar__link" href="/blog/">博客</a><a class="navbar__item navbar__link" href="/books/">书籍</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/neo-of-matrix" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/You-Dont-Know-React/API/DOM 元素 144a3/">You-Dont-Know-React</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/You-Dont-Know-React/API/DOM 元素 144a3/">API</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/You-Dont-Know-React/API/DOM 元素 144a3/">DOM 元素</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/You-Dont-Know-React/API/JavaScript a1d6b/">JavaScript 环境要求</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/You-Dont-Know-React/API/React/Fragments a517d/">React</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/You-Dont-Know-React/API/React Comp 19041/">React.Component</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/You-Dont-Know-React/API/ReactDOM 9da06/">ReactDOM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/You-Dont-Know-React/API/ReactDOMCl cb00c/">ReactDOMClient</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/You-Dont-Know-React/API/ReactDOMSe 05b15/">ReactDOMServer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/You-Dont-Know-React/API/Test Rende 001ad/">Test Renderer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/You-Dont-Know-React/API/Test Utili 57594/">Test Utilities</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/You-Dont-Know-React/API/合成事件 49064/">合成事件</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/You-Dont-Know-React/Context cb458/">Context</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/You-Dont-Know-React/FAQ 852cd/">FAQ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/You-Dont-Know-React/Fragments cd886/">Fragments</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/You-Dont-Know-React/JSX 4ab1c/">JSX</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/You-Dont-Know-React/Portals 512bb/">Portals</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/You-Dont-Know-React/Profiler组件 4b06e/">Profiler组件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/You-Dont-Know-React/Props 470ef/">Props</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/You-Dont-Know-React/React Hook/Effect Hoo 6663b/">React Hook</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/You-Dont-Know-React/React 组合开发 a8a1c/">React 组合开发模式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/You-Dont-Know-React/React 编程思考 a59ce/">React 编程思考</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/You-Dont-Know-React/Refs f35f2/">Refs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/You-Dont-Know-React/Render Pro 631f5/">Render Props</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/You-Dont-Know-React/State 44037/">State</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/You-Dont-Know-React/Web Compon 44e73/">Web Components</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/You-Dont-Know-React/key 4e930/">key</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/You-Dont-Know-React/与第三方库协同 cd240/">与第三方库协同</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/You-Dont-Know-React/严格模式 c692d/">严格模式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/You-Dont-Know-React/事件处理 9b848/">事件处理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/You-Dont-Know-React/代码分割 eb57c/">代码分割</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/You-Dont-Know-React/受控组件和非受控组件 0e71a/">受控组件和非受控组件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/You-Dont-Know-React/性能优化 3bd5f/">性能优化</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/You-Dont-Know-React/条件渲染 8a03a/">条件渲染</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/You-Dont-Know-React/状态提升 9445e/">状态提升</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/You-Dont-Know-React/类型检查 e77ac/">类型检查</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/You-Dont-Know-React/错误边界 25eda/">错误边界</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/You-Dont-Know-React/高阶组件 349dd/">高阶组件</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/about/">关于</a></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/">🏠</a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><span class="breadcrumbs__link" itemprop="item name">You-Dont-Know-React</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><span class="breadcrumbs__link" itemprop="item name">API</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="item name">React.Component</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>React.Component</h1><h3 class="anchor anchorWithStickyNavbar_mojV" id="概览"><strong>概览</strong><a class="hash-link" href="#概览" title="Direct link to heading">​</a></h3><p>React 的组件可以定义为 class 或函数的形式</p><p>如需定义 class 组件，需要继承 <code>React.Component</code></p><p>在 <code>React.Component</code>的子类中有个必须定义的 <code>[render()](https://zh-hans.reactjs.org/docs/react-component.html#render)</code>函数</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="组件的生命周期"><strong>组件的生命周期</strong><a class="hash-link" href="#组件的生命周期" title="Direct link to heading">​</a></h3><p><strong><a href="https://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/" target="_blank" rel="noopener noreferrer">生命周期图谱</a></strong></p><p><a href="https://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/" target="_blank" rel="noopener noreferrer">React Lifecycle Methods diagram</a></p><p>挂载</p><p>当组件实例被创建并插入 DOM 中时，其生命周期调用顺序如下：</p><ul><li><strong><code>[constructor()](https://zh-hans.reactjs.org/docs/react-component.html#constructor)</code></strong><ul><li>通过给 <code>this.state</code> 赋值对象来初始化<a href="https://zh-hans.reactjs.org/docs/state-and-lifecycle.html" target="_blank" rel="noopener noreferrer">内部 state</a></li><li>为<a href="https://zh-hans.reactjs.org/docs/handling-events.html" target="_blank" rel="noopener noreferrer">事件处理函数</a>绑定实例</li><li>在 React 组件挂载之前，会调用它的构造函数</li><li>其他语句之前调用 <code>super(props)</code>，否则，<code>this.props</code> 在构造函数中可能会出现未定义的 bug</li><li>在 <code>constructor()</code> 函数中<strong>不要调用 <code>setState()</code> 方法</strong></li><li>不要在构造函数中引入任何副作用或订阅<!-- -->  放在 <code>componentDidMount</code> 中
</li><li><strong>避免将 props 的值复制给 state</strong><ul><li>产生了 bug，更新 prop 中的 <code>color</code> 时，state 不会改变</li><li><strong>刻意忽略 prop 更新的情况下使用</strong><ul><li>prop 添加<code>initial</code> 或 <code>default</code> 前缀</li><li>通过<a href="https://zh-hans.reactjs.org/blog/2018/06/07/you-probably-dont-need-derived-state.html#recommendation-fully-uncontrolled-component-with-a-key" target="_blank" rel="noopener noreferrer">修改它的 <code>key</code></a>，以强制“重置”其内部 state</li></ul></li></ul></li></ul></li><li><code>static getDerivedStateFromProps(props, state)</code><ul><li>调用 render 方法之前调用</li><li>返回一个对象来更新 state，如果返回 <code>null</code> 则不更新任何内容</li><li>state 的值在任何时候都取决于 props <code>&lt;Transition&gt;</code> 组件</li><li>无权访问组件实例<!-- -->  通过提取组件 props 的纯函数及 class 之外的状态，在<code>getDerivedStateFromProps()</code>
和其他 class 方法之间重用代码
</li><li><a href="https://zh-hans.reactjs.org/blog/2018/06/07/you-probably-dont-need-derived-state.html" target="_blank" rel="noopener noreferrer">替代方案</a><ul><li>如果你需要<strong>执行副作用</strong>（例如，数据提取或动画）以响应 props 中的更改，请改用 <code>[componentDidUpdate](https://zh-hans.reactjs.org/docs/react-component.html#componentdidupdate)</code></li><li>如果只想在 <strong>prop 更改时重新计算某些数据</strong>，<a href="https://zh-hans.reactjs.org/blog/2018/06/07/you-probably-dont-need-derived-state.html#what-about-memoization" target="_blank" rel="noopener noreferrer">请使用 memoization helper 代替</a></li><li>如果你想<strong>在 prop 更改时“重置”某些 state</strong>，请考虑使组件<a href="https://zh-hans.reactjs.org/blog/2018/06/07/you-probably-dont-need-derived-state.html#recommendation-fully-controlled-component" target="_blank" rel="noopener noreferrer">完全受控</a>或<a href="https://zh-hans.reactjs.org/blog/2018/06/07/you-probably-dont-need-derived-state.html#recommendation-fully-uncontrolled-component-with-a-key" target="_blank" rel="noopener noreferrer">使用 <code>key</code> 使组件完全不受控</a> 代替</li></ul></li></ul></li><li><strong><code>[render()](https://zh-hans.reactjs.org/docs/react-component.html#render)</code></strong><ul><li>获取 <code>this.props</code> 和 <code>this.state</code>，并返回以下类型<ul><li>React 元素<ul><li><div></div> 会被 React 渲染为 DOM 节点</li><li><div></div> 会被 React 渲染为自定义组件</li></ul></li><li>数组或 fragments<!-- -->  使得 render 方法可以返回多个元素
</li><li>Portals<!-- -->  可以渲染子节点到不同的 DOM 子树中
</li><li>字符串或数值类型
DOM 中会被渲染为文本节点</li><li>布尔类型或 null
什么都不渲染</li></ul></li><li>纯函数，这意味着在不修改组件 state 的情况下，每次调用时都返回相同的结果，并且它不会直接与浏览器交互</li><li><code>shouldComponentUpdate()</code> 返回 false，则不会调用 <code>render()</code></li></ul></li><li><strong><code>[componentDidMount()](https://zh-hans.reactjs.org/docs/react-component.html#componentdidmount)</code></strong><ul><li>组件挂载后（插入 DOM 树中）立即调用</li><li>依赖于 DOM 节点的初始化，modals 和 tooltips</li><li>网络请求获取数据</li><li>添加订阅</li><li><strong>直接调用 <code>setState()</code>，调用两次render</strong>，但此渲染会发生在浏览器更新屏幕之前，导致性能问题</li></ul></li></ul><p>更新</p><p>当组件的 props 或 state 发生变化时会触发更新。组件更新的生命周期调用顺序如下：</p><ul><li><code>static getDerivedStateFromProps(props, state)</code></li><li><code>shouldComponentUpdate(nextProps, nextState)</code><ul><li>根据 <code>shouldComponentUpdate()</code> 的返回值判断是否调用render</li><li>默认行为是 state 和 props 每次发生变化组件都会重新渲染</li><li>首次渲染或使用 <code>forceUpdate()</code> 时不会调用该方法</li><li><code>this.props</code> 与 <code>nextProps</code> 以及 <code>this.state</code> 与<code>nextState</code> 进行比较，并返回 <code>false</code> 以告知 React 可以跳过更新</li><li>返回 <code>false</code> 并不会阻止子组件在 state 更改时重新渲染</li><li>不要进行深层比较或使用 <code>JSON.stringify()</code></li><li>不会调用 <code>[render()](https://zh-hans.reactjs.org/docs/react-component.html#render)</code> 和 <code>[componentDidUpdate()](https://zh-hans.reactjs.org/docs/react-component.html#componentdidupdate)</code></li></ul></li><li><strong><code>[render()](https://zh-hans.reactjs.org/docs/react-component.html#render)</code></strong></li><li><code>getSnapshotBeforeUpdate(prevProps, prevState)</code><ul><li>render 和 commit 之间调用</li><li>捕获DOM一些信息（例如，滚动位置）</li><li>返回值将作为参数传递给 <code>componentDidUpdate()</code></li></ul></li><li><code>componentDidUpdate(prevProps, prevState, snapshot)</code><ul><li>首次渲染不会执行此方法</li><li>对 DOM 进行操作</li><li>更新前后的 props 进行了比较进行网络请求</li><li>调用 <code>setState()</code> 增加判断条件，导致额外的重新渲染</li><li><code>snapshot</code> 默认为 undefined</li></ul></li></ul><p>卸载</p><p>当组件从 DOM 中移除时会调用如下方法：</p><ul><li><strong><code>[componentWillUnmount()](https://zh-hans.reactjs.org/docs/react-component.html#componentwillunmount)</code></strong><ul><li>组件卸载及销毁之前直接调用</li><li>清除 timer，取消网络请求或清除在 <code>componentDidMount()</code> 中创建的订阅</li></ul></li></ul><p>错误处理</p><p>当渲染过程，生命周期，或子组件的构造函数中抛出错误时，会调用如下方法：</p><ul><li><code>static getDerivedStateFromError(error)</code><ul><li>后代组件抛出错误后被调用</li><li>抛出的错误作为参数</li><li>返回一个值以更新 state</li><li>不允许出现副作用</li></ul></li><li><code>componentDidCatch(error, info)</code><ul><li>后代组件抛出错误后被调用</li><li>在“提交”阶段被调用，因此允许上传错误信息</li><li><code>error</code> —— 抛出的错误</li><li><code>info</code>.<code>componentStack</code>  —— <a href="https://zh-hans.reactjs.org/docs/error-boundaries.html#component-stack-traces" target="_blank" rel="noopener noreferrer">有关组件引发错误的栈信息</a></li><li>React 的开发和生产构建版本在 <code>componentDidCatch()</code> 的方式上有轻微差别<ul><li>在开发模式下，<code>componentDidCatch()</code>处理错误以后错误还是会冒泡至 <code>window</code></li><li>在生产模式下，错误不会冒泡</li></ul></li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="其他-apis">其他 APIs<a class="hash-link" href="#其他-apis" title="Direct link to heading">​</a></h3><p>组件还提供了一些额外的 API：</p><ul><li><code>setState(updater, [callback])</code><ul><li><code>setState()</code> 将对组件 state 的更改排入队列，并通知 React 需要使用更新后的 state 重新渲染此组件及其子组件</li><li>并不总是立即更新组件<ul><li><code>componentDidUpdate</code> 或者 <code>setState</code> 的回调函数（<code>setState(updater, callback)</code>）</li></ul></li><li><code>updater</code> 函数<ul><li><code>(state, props) =&gt; stateChange</code></li><li>updater 的返回值会与 <code>state</code> 进行浅合并</li></ul></li><li>updater 对象<ul><li>传入的对象浅层合并到新的 state 中</li></ul></li><li><code>callback</code> 函数<ul><li><code>setState</code> 完成合并并重新渲染组件后执行</li><li>使用 <code>componentDidUpdate()</code> 来代替此方式</li></ul></li></ul></li><li><code>component.forceUpdate(callback)</code><ul><li><code>render()</code> 方法依赖于其他数据，则可以调用 <code>forceUpdate()</code> 强制让组件重新渲染</li><li>跳过该组件的 <code>shouldComponentUpdate()</code></li><li>子组件会触发正常的生命周期方法</li></ul></li></ul><p>class 属性</p><ul><li><code>[defaultProps](https://zh-hans.reactjs.org/docs/react-component.html#defaultprops)</code>  Class 组件添加默认 props
</li><li><code>[displayName](https://zh-hans.reactjs.org/docs/react-component.html#displayname)</code>  显示名称或创建高阶组件
</li></ul><p>实例属性</p><ul><li><code>[props](https://zh-hans.reactjs.org/docs/react-component.html#props)</code>  <code>this.props.children</code> 是一个特殊的 prop，通常由 JSX 表达式中的子组件组成，而非组件本身定义
</li><li><code>[state](https://zh-hans.reactjs.org/docs/react-component.html#state)</code>  如果某些值未用于渲染或数据流（例如，计时器 ID），则不必将其设置为 state。此类值可以在组件实例上定义。</li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/You-Dont-Know-React/API/React/转换元素 03d6e/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">转换元素</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/You-Dont-Know-React/API/ReactDOM 9da06/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">ReactDOM</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#概览" class="table-of-contents__link toc-highlight"><strong>概览</strong></a></li><li><a href="#组件的生命周期" class="table-of-contents__link toc-highlight"><strong>组件的生命周期</strong></a></li><li><a href="#其他-apis" class="table-of-contents__link toc-highlight">其他 APIs</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">文档</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/about/">笔记</a></li></ul></div><div class="col footer__col"><div class="footer__title">社区</div><ul class="footer__items"></ul></div><div class="col footer__col"><div class="footer__title">更多</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog/">博客</a></li><li class="footer__item"><a href="https://github.com/neo-of-matrix" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 neo-of-matrix, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.674d6470.js"></script>
<script src="/assets/js/main.68822ab4.js"></script>
</body>
</html>